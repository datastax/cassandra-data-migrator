
1. Created AWS t2.2xlarge instance running AWS Linux
2. scp -i ~/.ssh/aws-oregon-phil-miesle.pem ./perf-iot.yaml ec2-user@54.148.45.187:perf-iot.yaml
   scp -i ~/.ssh/aws-oregon-phil-miesle.pem ./cdm-v3.properties ec2-user@54.148.45.187:cdm-v3.properties
   scp -i ~/.ssh/aws-oregon-phil-miesle.pem ./cdm-v4.properties ec2-user@54.148.45.187:cdm-v4.properties
3. ssh -i ~/.ssh/aws-oregon-phil-miesle.pem ec2-user@54.148.45.187
   a. sudo yum install -y docker
      sudo usermod -a -G docker ec2-user
      newgrp docker
      sudo systemctl enable docker.service
      sudo systemctl start docker.service
   b. docker network create --driver=bridge --subnet=172.16.242.0/24 cassandra
   c. docker run --name cass-origin --network cassandra --ip 172.16.242.2 -e "CASS_USERNAME=cassandra" -e "CASS_PASSWORD=cassandra" -e "CASS_CLUSTER=origin" -p 9042:9042 -d cassandra:3.11.14
   d. docker run --name cass-target --network cassandra --ip 172.16.242.3 -e "CASS_USERNAME=cassandra" -e "CASS_PASSWORD=cassandra" -e "CASS_CLUSTER=target" -p 9043:9042 -d cassandra:4.1.1
   e. curl -L -O https://github.com/nosqlbench/nosqlbench/releases/latest/download/nb5
      chmod +x nb5
      ./nb5 --appimage-extract
      rm nb5
      ln -s squashfs-root/AppRun ./nb5
      ./nb5 --version
   f. ./nb5 perf-iot --progress console:5s load-cycles=1000000 host=localhost port=9042 localdc=datacenter1 
      ./nb5 perf-iot default.schema host=localhost port=9043 localdc=datacenter1

           cqlsh> select count(*) from devices.sensor_data;
           
            count
           --------
            999417
           
           (1 rows)

   g. docker run --name cdm --network cassandra --ip 172.16.242.4 -d datastax/cassandra-data-migrator:3.4.4
      docker cp cdm-v3.properties cdm:cdm-v3.properties

   h. docker exec -it cdm bash
      cqlsh cass-target -e 'TRUNCATE TABLE devices.sensor_data'

      time spark-submit --properties-file cdm-v3.properties \
        --conf spark.executor.cores=4 \
        --conf spark.origin.keyspaceTable="devices.sensor_data" \
        --master "local[*]" --class datastax.astra.migrate.Migrate \
        /assets/cassandra-data-migrator-3.4.4.jar &> cdm-v3-Migrate_$(date +%Y%m%d_%H_%M).txt

           real    1m2.661s
           user    1m50.624s
           sys     0m15.862s

           ################################################################################################
           ThreadID: 1 Final Read Record Count: 999417
           ThreadID: 1 Final Skipped Record Count: 0
           ThreadID: 1 Final Write Record Count: 999417
           ThreadID: 1 Final Error Record Count: 0
           ################################################################################################

      time spark-submit --properties-file cdm-v3.properties \
        --conf spark.executor.cores=4 \
        --conf spark.origin.keyspaceTable="devices.sensor_data" \
        --master "local[*]" --class datastax.astra.migrate.DiffData \
        /assets/cassandra-data-migrator-3.4.4.jar &> cdm-v3-DiffData_$(date +%Y%m%d_%H_%M).txt

           real    1m3.673s
           user    2m14.517s
           sys     0m36.715s
           
           ################################################################################################
           ThreadID: 1 Final Read Record Count: 999417
           ThreadID: 1 Final Mismatch Record Count: 0
           ThreadID: 1 Final Corrected Mismatch Record Count: 0
           ThreadID: 1 Final Missing Record Count: 0
           ThreadID: 1 Final Corrected Missing Record Count: 0
           ThreadID: 1 Final Valid Record Count: 977053
           ThreadID: 1 Final Skipped Record Count: 0
           ################################################################################################
